{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport { catchError, tap, map } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class OlympicService {\n  constructor(http) {\n    this.http = http;\n    this.olympicUrl = './assets/mock/olympic.json';\n    this.olympics$ = new BehaviorSubject([]);\n    this.MedalCountByCountry = new BehaviorSubject([]);\n  }\n  loadInitialData() {\n    return this.http.get(this.olympicUrl).pipe(tap(value => this.olympics$.next(value)), tap(value => this.MedalCountByCountry.next(this.getObjectMedal(value))), catchError((error, caught) => {\n      // TODO: improve error handling\n      console.error(error);\n      // can be useful to end loading state and let the user know something went wrong\n      this.olympics$.next([]);\n      return caught;\n    }));\n  }\n  getOlympics() {\n    return this.olympics$.asObservable();\n  }\n  getMedalCount() {\n    return this.MedalCountByCountry.asObservable();\n  }\n  getObjectMedal(olympic) {\n    let medalCounts = [];\n    for (let country in olympic) {\n      let totalMedalByCountry = 0;\n      let totalByCountry = {\n        name: '',\n        value: 0\n      };\n      totalMedalByCountry = olympic[country].participations.reduce((acc, item) => acc + item.medalsCount, 0);\n      totalByCountry.name = olympic[country].country;\n      totalByCountry.value = totalMedalByCountry;\n      medalCounts.push(totalByCountry);\n    }\n    return medalCounts;\n  }\n  getDataByCountry(country) {\n    return this.http.get(this.olympicUrl).pipe(tap(value => console.log(value)), map(data => data.filter(item => item.country === country)));\n  }\n  static #_ = this.ɵfac = function OlympicService_Factory(t) {\n    return new (t || OlympicService)(i0.ɵɵinject(i1.HttpClient));\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: OlympicService,\n    factory: OlympicService.ɵfac,\n    providedIn: 'root'\n  });\n}","map":{"version":3,"names":["BehaviorSubject","catchError","tap","map","OlympicService","constructor","http","olympicUrl","olympics$","MedalCountByCountry","loadInitialData","get","pipe","value","next","getObjectMedal","error","caught","console","getOlympics","asObservable","getMedalCount","olympic","medalCounts","country","totalMedalByCountry","totalByCountry","name","participations","reduce","acc","item","medalsCount","push","getDataByCountry","log","data","filter","_","i0","ɵɵinject","i1","HttpClient","_2","factory","ɵfac","providedIn"],"sources":["C:\\Users\\MBD7C62N\\Repo Git\\python\\Developpez-le-front-end-en-utilisant-Angular\\src\\app\\core\\services\\olympic.service.ts"],"sourcesContent":["import { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { BehaviorSubject, Observable } from 'rxjs';\r\nimport { catchError, tap, map } from 'rxjs/operators';\r\nimport { Olympic } from '../models/olympic';\r\nimport { MedalCount } from '../models/medal-count';\r\nimport { Participation } from '../models/participation';\r\n\r\n\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class OlympicService {\r\n  private olympicUrl = './assets/mock/olympic.json';\r\n  private olympics$ = new BehaviorSubject<Olympic[]>([]);\r\n  private MedalCountByCountry = new BehaviorSubject<MedalCount[]>([]);\r\n  \r\n\r\n  \r\n  constructor(private http: HttpClient) {}\r\n\r\n  \r\n  loadInitialData(): Observable<Olympic[]> {\r\n    return this.http.get<Olympic[]>(this.olympicUrl).pipe(\r\n      tap((value) => this.olympics$.next(value)),\r\n      tap((value) => this.MedalCountByCountry.next(this.getObjectMedal(value))),\r\n      catchError((error, caught) => {\r\n        // TODO: improve error handling\r\n        console.error(error);\r\n        // can be useful to end loading state and let the user know something went wrong\r\n        this.olympics$.next([]);\r\n        return caught;\r\n      })\r\n    );\r\n  }\r\n\r\n  getOlympics() {\r\n    return this.olympics$.asObservable();\r\n  }\r\n\r\n  \r\n\r\n  getMedalCount(){\r\n    return this.MedalCountByCountry.asObservable()\r\n  }\r\n\r\n    getObjectMedal(olympic: Olympic[]) {\r\n      let medalCounts : MedalCount[] = [];\r\n      \r\n      for (let country in olympic) {\r\n        let totalMedalByCountry = 0;\r\n        let totalByCountry: MedalCount = {name: '',\r\n                          value: 0};\r\n      \r\n        totalMedalByCountry = olympic[country].participations.reduce((acc, item) => acc + item.medalsCount, 0);\r\n        totalByCountry.name = olympic[country].country;\r\n        totalByCountry.value = totalMedalByCountry;\r\n      \r\n        medalCounts.push(totalByCountry);\r\n      }\r\n    \r\n      return medalCounts;\r\n\r\n}\r\n  getDataByCountry(country: string): Observable<Olympic[]> {\r\n    return this.http.get<Olympic[]>(this.olympicUrl).pipe(tap(value =>console.log(value)),\r\n      map(data => data.filter(item => item.country === country))\r\n    );\r\n  }\r\n\r\n\r\n}\r\n"],"mappings":"AAEA,SAASA,eAAe,QAAoB,MAAM;AAClD,SAASC,UAAU,EAAEC,GAAG,EAAEC,GAAG,QAAQ,gBAAgB;;;AAUrD,OAAM,MAAOC,cAAc;EAOzBC,YAAoBC,IAAgB;IAAhB,KAAAA,IAAI,GAAJA,IAAI;IANhB,KAAAC,UAAU,GAAG,4BAA4B;IACzC,KAAAC,SAAS,GAAG,IAAIR,eAAe,CAAY,EAAE,CAAC;IAC9C,KAAAS,mBAAmB,GAAG,IAAIT,eAAe,CAAe,EAAE,CAAC;EAI5B;EAGvCU,eAAeA,CAAA;IACb,OAAO,IAAI,CAACJ,IAAI,CAACK,GAAG,CAAY,IAAI,CAACJ,UAAU,CAAC,CAACK,IAAI,CACnDV,GAAG,CAAEW,KAAK,IAAK,IAAI,CAACL,SAAS,CAACM,IAAI,CAACD,KAAK,CAAC,CAAC,EAC1CX,GAAG,CAAEW,KAAK,IAAK,IAAI,CAACJ,mBAAmB,CAACK,IAAI,CAAC,IAAI,CAACC,cAAc,CAACF,KAAK,CAAC,CAAC,CAAC,EACzEZ,UAAU,CAAC,CAACe,KAAK,EAAEC,MAAM,KAAI;MAC3B;MACAC,OAAO,CAACF,KAAK,CAACA,KAAK,CAAC;MACpB;MACA,IAAI,CAACR,SAAS,CAACM,IAAI,CAAC,EAAE,CAAC;MACvB,OAAOG,MAAM;IACf,CAAC,CAAC,CACH;EACH;EAEAE,WAAWA,CAAA;IACT,OAAO,IAAI,CAACX,SAAS,CAACY,YAAY,EAAE;EACtC;EAIAC,aAAaA,CAAA;IACX,OAAO,IAAI,CAACZ,mBAAmB,CAACW,YAAY,EAAE;EAChD;EAEEL,cAAcA,CAACO,OAAkB;IAC/B,IAAIC,WAAW,GAAkB,EAAE;IAEnC,KAAK,IAAIC,OAAO,IAAIF,OAAO,EAAE;MAC3B,IAAIG,mBAAmB,GAAG,CAAC;MAC3B,IAAIC,cAAc,GAAe;QAACC,IAAI,EAAE,EAAE;QACxBd,KAAK,EAAE;MAAC,CAAC;MAE3BY,mBAAmB,GAAGH,OAAO,CAACE,OAAO,CAAC,CAACI,cAAc,CAACC,MAAM,CAAC,CAACC,GAAG,EAAEC,IAAI,KAAKD,GAAG,GAAGC,IAAI,CAACC,WAAW,EAAE,CAAC,CAAC;MACtGN,cAAc,CAACC,IAAI,GAAGL,OAAO,CAACE,OAAO,CAAC,CAACA,OAAO;MAC9CE,cAAc,CAACb,KAAK,GAAGY,mBAAmB;MAE1CF,WAAW,CAACU,IAAI,CAACP,cAAc,CAAC;IAClC;IAEA,OAAOH,WAAW;EAExB;EACEW,gBAAgBA,CAACV,OAAe;IAC9B,OAAO,IAAI,CAAClB,IAAI,CAACK,GAAG,CAAY,IAAI,CAACJ,UAAU,CAAC,CAACK,IAAI,CAACV,GAAG,CAACW,KAAK,IAAGK,OAAO,CAACiB,GAAG,CAACtB,KAAK,CAAC,CAAC,EACnFV,GAAG,CAACiC,IAAI,IAAIA,IAAI,CAACC,MAAM,CAACN,IAAI,IAAIA,IAAI,CAACP,OAAO,KAAKA,OAAO,CAAC,CAAC,CAC3D;EACH;EAAC,QAAAc,CAAA,G;qBAxDUlC,cAAc,EAAAmC,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA;EAAA;EAAA,QAAAC,EAAA,G;WAAdvC,cAAc;IAAAwC,OAAA,EAAdxC,cAAc,CAAAyC,IAAA;IAAAC,UAAA,EAFb;EAAM"},"metadata":{},"sourceType":"module","externalDependencies":[]}