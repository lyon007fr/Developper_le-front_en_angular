{"ast":null,"code":"import { BehaviorSubject } from 'rxjs';\nimport { catchError, tap, map } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class OlympicService {\n  constructor(http) {\n    this.http = http;\n    this.olympicUrl = './assets/mock/olympic.json';\n    this.olympics$ = new BehaviorSubject([]);\n    this.MedalCountByCountry = new BehaviorSubject([]);\n    this.numberOfJO = new BehaviorSubject(0);\n  }\n  loadInitialData() {\n    return this.http.get(this.olympicUrl).pipe(tap(value => this.olympics$.next(value)), tap(value => this.MedalCountByCountry.next(this.getObjectMedal(value))), tap(value), this.numberOfJO.next(this.getNumberOfJos(value)), catchError((error, caught) => {\n      // TODO: improve error handling\n      console.error(error);\n      // can be useful to end loading state and let the user know something went wrong\n      this.olympics$.next([]);\n      return caught;\n    }));\n  }\n  getOlympics() {\n    return this.olympics$.asObservable();\n  }\n  getMedalCount() {\n    return this.MedalCountByCountry.asObservable();\n  }\n  getObjectMedal(olympic) {\n    let medalCounts = [];\n    for (let country in olympic) {\n      let totalMedalByCountry = 0;\n      let totalByCountry = {\n        name: '',\n        value: 0\n      };\n      totalMedalByCountry = olympic[country].participations.reduce((acc, item) => acc + item.medalsCount, 0);\n      totalByCountry.name = olympic[country].country;\n      totalByCountry.value = totalMedalByCountry;\n      medalCounts.push(totalByCountry);\n    }\n    return medalCounts;\n  }\n  getDataByCountry(country) {\n    return this.http.get(this.olympicUrl).pipe(tap(value => console.log(value)),\n    //ajouter une gestion d'erreur\n    map(data => data.filter(item => item.country === country)));\n  }\n  getNumberOfJos(value) {\n    return value.length;\n  }\n  static #_ = this.ɵfac = function OlympicService_Factory(t) {\n    return new (t || OlympicService)(i0.ɵɵinject(i1.HttpClient));\n  };\n  static #_2 = this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: OlympicService,\n    factory: OlympicService.ɵfac,\n    providedIn: 'root'\n  });\n}","map":{"version":3,"names":["BehaviorSubject","catchError","tap","map","OlympicService","constructor","http","olympicUrl","olympics$","MedalCountByCountry","numberOfJO","loadInitialData","get","pipe","value","next","getObjectMedal","getNumberOfJos","error","caught","console","getOlympics","asObservable","getMedalCount","olympic","medalCounts","country","totalMedalByCountry","totalByCountry","name","participations","reduce","acc","item","medalsCount","push","getDataByCountry","log","data","filter","length","_","i0","ɵɵinject","i1","HttpClient","_2","factory","ɵfac","providedIn"],"sources":["C:\\Users\\MBD7C62N\\Repo Git\\python\\Developpez-le-front-end-en-utilisant-Angular\\src\\app\\core\\services\\olympic.service.ts"],"sourcesContent":["import { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { BehaviorSubject, Observable } from 'rxjs';\r\nimport { catchError, tap, map } from 'rxjs/operators';\r\nimport { Olympic } from '../models/olympic';\r\nimport { MedalCount } from '../models/medal-count';\r\nimport { Participation } from '../models/participation';\r\n\r\n\r\n\r\n@Injectable({\r\n  providedIn: 'root',\r\n})\r\nexport class OlympicService {\r\n  private olympicUrl = './assets/mock/olympic.json';\r\n  private olympics$ = new BehaviorSubject<Olympic[]>([]);\r\n  private MedalCountByCountry = new BehaviorSubject<MedalCount[]>([]);\r\n  private numberOfJO = new BehaviorSubject<number>(0)\r\n  \r\n\r\n  \r\n  constructor(private http: HttpClient) {}\r\n\r\n  \r\n  loadInitialData(): Observable<Olympic[]> {\r\n    return this.http.get<Olympic[]>(this.olympicUrl).pipe(\r\n      tap((value) => this.olympics$.next(value)),\r\n      tap((value) => this.MedalCountByCountry.next(this.getObjectMedal(value))),\r\n      tap((value)) => this.numberOfJO.next(this.getNumberOfJos(value))\r\n,      catchError((error, caught) => {\r\n        // TODO: improve error handling\r\n        console.error(error);\r\n        // can be useful to end loading state and let the user know something went wrong\r\n        this.olympics$.next([]);\r\n        return caught;\r\n      })\r\n    );\r\n  }\r\n\r\n  getOlympics() {\r\n    return this.olympics$.asObservable();\r\n  }\r\n\r\n  \r\n\r\n  getMedalCount(){\r\n    return this.MedalCountByCountry.asObservable()\r\n  }\r\n\r\n\r\n  getObjectMedal(olympic: Olympic[]) {\r\n      let medalCounts : MedalCount[] = [];\r\n      \r\n      for (let country in olympic) {\r\n        let totalMedalByCountry = 0;\r\n        let totalByCountry: MedalCount = {name: '',\r\n                          value: 0};\r\n      \r\n        totalMedalByCountry = olympic[country].participations.reduce((acc, item) => acc + item.medalsCount, 0);\r\n        totalByCountry.name = olympic[country].country;\r\n        totalByCountry.value = totalMedalByCountry;\r\n      \r\n        medalCounts.push(totalByCountry);\r\n      }\r\n    \r\n      return medalCounts;\r\n\r\n}\r\n  getDataByCountry(country: string): Observable<Olympic[]> {\r\n    return this.http.get<Olympic[]>(this.olympicUrl).pipe(tap(value =>console.log(value)),//ajouter une gestion d'erreur\r\n      map(data => data.filter(item => item.country === country))\r\n    );\r\n  }\r\n\r\n\r\n  getNumberOfJos(value:Olympic[]){\r\n      return value.length\r\n  }\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}